MODE: update
1) Call tool_search_knowledge(query) and tool_get_program_history().
   - Build a compact query that starts with `profile:` and lists key fields (gender, birth_year, weight, height,
     workout_goals, workout_experience, workout_location, health_notes) plus a short cue like "workout update".
   - Keep the query <=120 characters. Do not include role text, instructions, or anything starting with "MODE:".
2) Generate a new ProgramPayload using the expected workout and feedback.
3) Call tool_attach_gifs(plan.exercises_by_day) and replace plan.exercises_by_day with the returned list.
4) Call tool_save_program(plan) and return the resulting Program.

PROGRAM PAYLOAD REQUIREMENTS:
- Do not return empty or partially filled fields.
- Label each block as "Day 1", "Day 2", etc. Do not refer to calendar weekday names, and ensure each exercise includes a name, sets, and reps.
- If split_number is missing, set it to the number of workout days.
