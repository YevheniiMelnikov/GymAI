@font-face {
  font-family: "Inter";
  src: url("../fonts/Inter-Regular.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Inter";
  src: url("../fonts/Inter-Bold.woff2") format("woff2");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Euclid Circular A";
  src: url("../fonts/EuclidCircularA-Regular.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Euclid Circular A";
  src: url("../fonts/EuclidCircularA-Medium.woff2") format("woff2");
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Euclid Circular A";
  src: url("../fonts/EuclidCircularA-Bold.woff2") format("woff2");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

:root{
  --bg: var(--tg-theme-bg-color, #ffffff);
  --surface: var(--tg-theme-secondary-bg-color, #f4f6f8);
  --text: var(--tg-theme-text-color, #1f2328);
  --muted: var(--tg-theme-hint-color, #7a869a);
  --link: var(--tg-theme-link-color, #2481cc);
  --accent: var(--tg-theme-button-color, #2a9af0);
  --accent-contrast: var(--tg-theme-button-text-color, #ffffff);

  --border: color-mix(in oklab, var(--text) 12%, transparent);
  --radius: 12px;
  --radius-sm: 10px;
  --shadow: 0 6px 24px rgba(0,0,0,.08);
  --shadow-strong: 0 12px 38px rgba(0,0,0,.16);
  --spacing: 16px;
  --spacing-lg: 22px;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg: var(--tg-theme-bg-color, #0f141a);
    --surface: var(--tg-theme-secondary-bg-color, #151b22);
    --text: var(--tg-theme-text-color, #e6edf3);
    --muted: var(--tg-theme-hint-color, #8b98a5);
    --link: var(--tg-theme-link-color, #6bb6ff);
    --accent: var(--tg-theme-button-color, #408ce6);
    --accent-contrast: var(--tg-theme-button-text-color, #0b0f14);
    --border: color-mix(in oklab, var(--text) 14%, transparent);
    --shadow: 0 8px 28px rgba(0,0,0,.35);
    --shadow-strong: 0 14px 46px rgba(0,0,0,.45);
  }
}

@media (prefers-color-scheme: light){
  :root{
    --bg: var(--tg-theme-bg-color, #f7f8f9);
    --surface: var(--tg-theme-secondary-bg-color, #eef1f4);
    --border: color-mix(in oklab, var(--text) 16%, transparent);
    --shadow: 0 8px 24px rgba(15, 23, 42, .08);
  }
}

*,
*::before,
*::after { box-sizing: border-box; }

html,
body {
  height: 100%;
  background: var(--bg);
  overflow-x: hidden;
  user-select: none;
}

body{
  margin: 0;
  min-height: 100dvh;
  display: flex;
  flex-direction: column;
  background: var(--bg);
  color: var(--text);
  font-family: "Inter","Euclid Circular A",
    -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",
    Arial,system-ui,sans-serif;
  font-size: 15px;
  line-height: 1.5;
  color-scheme: light dark;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  touch-action: manipulation;
}

*{
  scrollbar-width: none;
}
*::-webkit-scrollbar{
  width: 0;
  height: 0;
}
*::-webkit-scrollbar-thumb{
  background: transparent;
}
*::-webkit-scrollbar-track{
  background: transparent;
}

main#app{
  width: 100%;
  min-height: 100dvh;
  background: transparent;
  flex: 1 0 auto;
  --app-padding-top: calc(clamp(18px, 2.4vw, 28px) + max(10px, env(safe-area-inset-top)));
  --app-padding-right: calc(clamp(18px, 2.4vw, 28px) + max(12px, env(safe-area-inset-right)));
  --app-padding-bottom: calc(clamp(18px, 2.4vw, 28px) + max(16px, env(safe-area-inset-bottom)));
  --app-padding-left: calc(clamp(18px, 2.4vw, 28px) + max(12px, env(safe-area-inset-left)));
  padding: var(--app-padding-top) var(--app-padding-right) var(--app-padding-bottom) var(--app-padding-left);
  display: flex;
  flex-direction: column;
  align-items: stretch;
  gap: clamp(18px, 2.4vw, 26px);
  overflow-x: hidden;
  user-select: none;
}


.app-header{
  display: flex;
  align-items: center;
  justify-content: center;
  padding-top: 4px;
  text-align: center;
}

.topbar{
  position: sticky;
  top: 0;
  left: 0;
  right: 0;
  z-index: 12;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding-block: 12px;
  padding-inline-start: var(--app-padding-left);
  padding-inline-end: var(--app-padding-right);
  margin: 0;
  margin-left: calc(-1 * var(--app-padding-left));
  margin-right: calc(-1 * var(--app-padding-right));
  border-radius: 0;
  background: color-mix(in oklab, var(--surface) 92%, var(--bg));
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: none;
}
.topbar__leading{
  flex: 0 0 auto;
  width: 42px;
  height: 42px;
  display: inline-flex;
  align-items: center;
  justify-content: flex-start;
}
.topbar__back{
  width: 42px;
  height: 42px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  appearance: none;
  -webkit-appearance: none;
  border: none;
  border-radius: 14px;
  background: transparent;
  color: color-mix(in oklab, var(--text) 90%, var(--accent));
  cursor: pointer;
  box-shadow: none;
  outline: none;
  transition: transform .08s ease, background .2s ease, color .2s ease;
}
.topbar__back:hover{
  transform: translateY(-1px);
  background: color-mix(in oklab, var(--surface) 80%, var(--bg));
}
.topbar__back:active{ transform: translateY(0); }
.topbar__title{
  margin: 0;
  flex: 1;
  text-align: center;
  font-size: clamp(22px, 4vw, 26px);
  font-weight: 700;
  line-height: 1.2;
}
.topbar__actions{
  min-width: 42px;
  min-height: 42px;
  display: inline-flex;
  align-items: center;
  justify-content: flex-end;
}
.topbar__icon{
  width: 22px;
  height: 22px;
  display: inline-block;
  background-color: currentColor;
  -webkit-mask-size: contain;
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-size: contain;
  mask-repeat: no-repeat;
  mask-position: center;
}
.topbar__icon--archive{
  -webkit-mask-image: url("/static/images/archive.svg");
  mask-image: url("/static/images/archive.svg");
}
.topbar__spacer{
  width: 42px;
  height: 42px;
  display: inline-flex;
}

@media (prefers-color-scheme: light){
  .topbar{
    background: color-mix(in oklab, var(--bg) 92%, #ffffff);
    border-bottom: 1px solid var(--border);
    box-shadow: 0 10px 24px rgba(15, 23, 42, .08);
  }
  .topbar__back{
    background: transparent;
    border: none;
    color: color-mix(in oklab, var(--text) 72%, var(--muted));
    box-shadow: none;
  }
  .topbar__back:hover{
    background: color-mix(in oklab, var(--surface) 70%, transparent);
  }
  .topbar__back:focus-visible{
    outline: 2px solid color-mix(in oklab, var(--accent) 55%, transparent);
    outline-offset: 2px;
  }
  .topbar__actions,
  .topbar__icon{
    color: color-mix(in oklab, var(--text) 70%, var(--muted));
  }
}

@media (prefers-color-scheme: light){
  .payment-card{
    background: color-mix(in oklab, #ffffff 92%, var(--surface));
    border: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
    box-shadow: 0 14px 32px rgba(15, 23, 42, .08);
  }
  .payment-frame{
    background: color-mix(in oklab, #ffffff 88%, var(--surface));
    border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
    box-shadow: 0 8px 20px rgba(15, 23, 42, .07);
  }
  .program-day,
  .program-day-card{
    background: color-mix(in oklab, #ffffff 90%, var(--surface));
    border: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
    box-shadow: 0 10px 22px rgba(15, 23, 42, .08);
  }
  .program-day-summary:hover,
  .program-day button:hover,
  .program-day a:hover,
  .program-day-card > *:hover{
    background: color-mix(in oklab, var(--surface) 78%, #ffffff);
  }
  .program-day:is(:hover, :focus-within),
  .program-day-card:is(:hover, :focus-within){
    border-color: color-mix(in oklab, var(--link) 38%, transparent);
    box-shadow: 0 14px 28px rgba(15, 23, 42, .1);
  }
  .exercise-dialog__panel,
  .exercise-edit-dialog__panel{
    background: color-mix(in oklab, #ffffff 92%, var(--surface));
    border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
    box-shadow: 0 18px 36px rgba(15, 23, 42, .12);
  }
}

.page-shell{
  width: 100%;
  max-width: 920px;
  align-self: center;
  display: flex;
  flex-direction: column;
  gap: clamp(18px, 2.4vw, 26px);
  flex: 1 1 auto;
}

.page-container{
  display: flex;
  flex-direction: column;
  gap: clamp(16px, 2.2vw, 22px);
  flex: 1 1 auto;
  min-height: 100%;
}

.app-header h1,
h1.page-title,
#page-title{
  margin: 0;
  font-size: clamp(22px, 4vw, 26px);
  font-weight: 700;
  line-height: 1.2;
  text-align: center;
}

#program-date {
  display: block;
  margin: 0;
  padding: 0 !important;
  background: none !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  font-size: 12.5px;
  color: var(--muted);
  letter-spacing: .02em;
  width: auto;
}
#program-date::before,
#program-date::after { content: none !important; }

#program-date:not(:empty){
  margin-top: clamp(16px, 2.4vw, 22px);
}

#controls {
  margin-top: auto;
  border: none;
  background: transparent;
  box-shadow: none;
}

#program-origin {
  display: block;
  margin: 0 0 8px 0;
  padding: 0;
  background: transparent;
  border: 0;
  border-radius: 0;
  font-size: 12.5px;
  color: var(--muted);
  letter-spacing: .02em;
  width: auto;
}
#program-origin.ai-label{
  color: color-mix(in oklab, var(--accent) 84%, var(--text));
  background: color-mix(in oklab, var(--accent) 16%, var(--bg));
  border-color: color-mix(in oklab, var(--accent) 28%, var(--border));
  font-weight: 700;
}

/* Content */
#content{
  white-space: normal;
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
  font-size: clamp(14px, 1.5vw, 15.5px);
  line-height: 1.6;
  margin: 0;
  width: 100%;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  gap: clamp(20px, 2.8vw, 28px);
  position: relative;
}
#content[aria-busy="true"]{ opacity:.7; }
#content[aria-busy="true"]::after{
  content:"";
  position:absolute;
  inset:0;
  z-index:2;
  background: color-mix(in oklab, var(--bg) 40%, transparent);
  backdrop-filter: blur(1.5px);
  -webkit-backdrop-filter: blur(1.5px);
}
#content[aria-busy="true"]::before{
  content:"";
  position:absolute;
  top:50%;
  left:50%;
  z-index:3;
  width:36px;
  height:36px;
  margin:-18px 0 0 -18px;
  border-radius:50%;
  border:3px solid color-mix(in oklab, var(--text) 25%, transparent);
  border-top-color: var(--link);
  animation: spin .9s linear infinite;
  box-shadow: 0 2px 10px rgba(0,0,0,.15);
}
#content::selection{
  background: color-mix(in oklab, var(--accent) 28%, transparent);
  color: var(--text);
}

.payment-card{
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: clamp(18px, 2.6vw, 24px);
  border: 1px solid var(--border);
  border-radius: clamp(14px, 2.4vw, 18px);
  background: color-mix(in oklab, var(--surface) 94%, var(--bg));
  box-shadow: var(--shadow);
}
.payment-heading{
  margin: 0;
  font-size: clamp(18px, 2.4vw, 21px);
  font-weight: 700;
}
.payment-amount{
  margin: 0;
  font-weight: 700;
  font-size: clamp(18px, 2.6vw, 22px);
}
.payment-note{
  margin: 0;
  color: var(--muted);
}
.payment-frame{
  min-height: 420px;
  border: 1px solid var(--border);
  border-radius: clamp(12px, 2vw, 16px);
  background: color-mix(in oklab, var(--bg) 92%, var(--surface));
  box-shadow: 0 2px 10px color-mix(in oklab, var(--text) 12%, transparent);
  overflow: hidden;
}
.payment-frame[aria-busy="true"]{
  position: relative;
}
.payment-frame[aria-busy="true"]::after{
  content:"";
  position:absolute;
  inset:0;
  background: color-mix(in oklab, var(--bg) 35%, transparent);
}
.payment-frame[aria-busy="true"]::before{
  content:"";
  position:absolute;
  top:50%;
  left:50%;
  width:32px;
  height:32px;
  margin:-16px 0 0 -16px;
  border-radius:50%;
  border:3px solid color-mix(in oklab, var(--text) 22%, transparent);
  border-top-color: var(--link);
  animation: spin .95s linear infinite;
  z-index:1;
}
.payment-actions{
  margin-top: 4px;
  display: grid;
  gap: 10px;
}
.payment-actions .primary-button{
  width: 100%;
}

.notice{
  border: 1px dashed var(--border);
  border-radius: 10px;
  padding: 10px 12px;
  background: color-mix(in oklab, var(--bg) 92%, transparent);
  color: var(--text);
}

.history-footer{
  margin-top: clamp(16px, 2.4vw, 28px);
  padding-top: clamp(16px, 2.4vw, 26px);
  display: flex;
  justify-content: center;
  border: none;
  background: transparent;
}

.primary-button,
#history-btn,
.history-footer button{
  width: 100%;
  max-width: 460px;
  appearance: none;
  border: none;
  background: var(--accent);
  color: var(--accent-contrast);
  font-weight: 700;
  letter-spacing: .01em;
  border-radius: 14px;
  padding: 14px 18px;
  min-height: 48px;
  font-size: 15.5px;
  cursor: pointer;
  transition: transform .06s ease, background .2s ease, opacity .2s ease;
  box-shadow: none;
}
.primary-button:hover,
#history-btn:hover,
.history-footer button:hover{
  transform: translateY(-1px);
}
.primary-button:active,
#history-btn:active,
.history-footer button:active{
  transform: translateY(0);
}
.primary-button:disabled,
#history-btn:disabled,
.history-footer button:disabled{
  opacity:.6; cursor:not-allowed;
}

.history-footer #history-button,
.history-footer button#history-button.primary-button {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  background: #2d74ff !important;
  color: #fff !important;
  font-weight: 600;
  border-radius: 16px;
  padding: 16px 20px;
  font-size: 16px;
  min-height: 56px;
  box-shadow: none;
}

.history-footer #history-button::before,
.history-footer button#history-button.primary-button::before {
  content: "";
  width: 20px;
  height: 20px;
  display: inline-block;
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M3 3v5h5'/><path d='M3 12a9 9 0 1 0 9-9'/><path d='M12 7v5l3 3'/></svg>");
}

.history-footer #history-button.back::before,
.history-footer button#history-button.back.primary-button::before {
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><polyline points='15 18 9 12 15 6'/></svg>");
}

.week{
  margin: 0;
  padding: 0;
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1.2vw, 12px);
}
.week + .week{ margin-top: clamp(24px, 3.4vw, 36px); }
.week h2{
  margin: 0;
  font-size: clamp(18px, 2.4vw, 21px);
  font-weight: 700;
}

.program-day,
.program-day-card{
  margin: 0;
  border: 1px solid color-mix(in oklab, var(--text) 18%, transparent);
  border-radius: clamp(16px, 3vw, 22px);
  background: color-mix(in oklab, var(--surface) 90%, transparent);
  box-shadow: 0 1px 4px color-mix(in oklab, var(--text) 10%, transparent);
  padding: 0;
  overflow: hidden;
  transition: border-color .25s ease, background .25s ease, box-shadow .25s ease;
}
.program-day + .program-day,
.program-day-card + .program-day-card{ margin-top: clamp(6px, 1.2vw, 12px); }
.week > .program-day + .program-day,
.week > .program-day-card + .program-day-card{ margin-top: 0; }
.program-day-summary,
.program-day button,
.program-day a,
.program-day-card > *{
  list-style: none;
  padding: clamp(18px, 2.6vw, 24px) clamp(22px, 3.2vw, 30px);
  margin: 0;
  font-size: clamp(16px, 2.3vw, 18px);
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 12px;
  border-radius: inherit;
  background: transparent;
  width: 100%;
  text-align: left;
  transition: color .25s ease, background .25s ease;
}
.program-day summary::-webkit-details-marker{ display: none; }
.program-day summary::marker{ display: none; }
.program-day-summary::after{
  content: '';
  width: 9px;
  height: 9px;
  border-right: 2px solid currentColor;
  border-bottom: 2px solid currentColor;
  transform: rotate(-45deg);
  transition: transform .25s ease;
  margin-left: auto;
}
.program-day-summary:hover,
.program-day button:hover,
.program-day a:hover,
.program-day-card > *:hover{
  color: color-mix(in oklab, var(--text) 84%, var(--link));
  background: color-mix(in oklab, var(--surface) 72%, transparent);
}
.program-day:is(:hover, :focus-within),
.program-day-card:is(:hover, :focus-within){
  border-color: color-mix(in oklab, var(--link) 34%, transparent);
  box-shadow: 0 4px 14px color-mix(in oklab, var(--text) 16%, transparent);
}
.program-day[open] .program-day-summary{
  color: color-mix(in oklab, var(--text) 86%, var(--link));
  background: color-mix(in oklab, var(--surface) 64%, transparent);
}
.program-day[open]{
  border-color: color-mix(in oklab, var(--link) 36%, transparent);
  box-shadow: 0 4px 16px color-mix(in oklab, var(--text) 18%, transparent);
}
.program-day[open] .program-day-summary::after{
  transform: rotate(45deg);
}
.program-day-summary:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 64%, transparent);
  outline-offset: 2px;
}
.program-day-rest .program-day-summary{
  cursor: default;
  color: var(--muted);
  pointer-events: none;
}
.program-day-rest .program-day-summary::after{ display: none; }

.program-day-list{
  list-style: none;
  padding: 0 clamp(22px, 3.2vw, 30px) clamp(18px, 2.6vw, 24px);
  margin: clamp(6px, 1.4vw, 12px) 0 0;
  display: flex;
  flex-direction: column;
  gap: clamp(10px, 1.6vw, 16px);
  max-height: 0;
  opacity: 0;
  overflow: hidden;
  transform: translateY(-4px);
  transition: max-height .32s ease, opacity .22s ease, transform .32s ease;
  will-change: max-height, opacity, transform;
}
.program-day[open] .program-day-list{
  max-height: 2000px;
  opacity: 1;
  transform: translateY(0);
}
.faq-answer{
  font-size: clamp(12px, 1.9vw, 14px);
  color: var(--muted);
  line-height: 1.5;
}
.faq-answer p{ margin: 0; }
.faq-answer p + p{ margin-top: 8px; }
.program-exercise-details{
  border: none;
  border-radius: clamp(12px, 2.4vw, 16px);
  background: transparent;
  overflow: hidden;
}
.program-exercise-details summary::-webkit-details-marker{ display: none; }
.program-exercise-details summary::marker{ display: none; }
.program-exercise-summary{
  list-style: none;
  padding: clamp(8px, 1.6vw, 12px) clamp(16px, 2.6vw, 22px);
  margin: 0;
  font-weight: 600;
  font-size: clamp(14px, 2vw, 15px);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 10px;
  border-radius: clamp(12px, 2.4vw, 16px);
  transition: color .2s ease, background .2s ease;
}
.program-exercise-summary::after{
  content: '';
  width: 8px;
  height: 8px;
  border-right: 2px solid currentColor;
  border-bottom: 2px solid currentColor;
  transform: rotate(-45deg);
  transition: transform .2s ease;
  margin-left: auto;
}
.program-exercise-details--loading .program-exercise-summary{
  cursor: default;
  pointer-events: none;
}
.program-exercise-details--loading .program-exercise-summary::after{
  width: 14px;
  height: 14px;
  border-radius: 999px;
  border: 2px solid color-mix(in oklab, var(--link) 60%, transparent);
  border-top-color: var(--link);
  transform: none;
  animation: spin .7s linear infinite;
}
.program-exercise-summary:hover{
  color: color-mix(in oklab, var(--text) 86%, var(--link));
  background: color-mix(in oklab, var(--surface) 68%, transparent);
}
.program-exercise-details[open] .program-exercise-summary{
  color: color-mix(in oklab, var(--text) 80%, var(--link));
  background: color-mix(in oklab, var(--surface) 58%, transparent);
}
.program-exercise-details[open] .program-exercise-summary::after{
  transform: rotate(45deg);
}
.program-exercise-details-static{
  border: none;
  border-radius: clamp(12px, 2.4vw, 16px);
  background: transparent;
}
.program-exercise-summary-static{
  cursor: default;
  pointer-events: none;
}
.program-exercise-summary-static::after{ content: none; }
.program-exercise-summary:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 54%, transparent);
  outline-offset: 2px;
}
.program-exercise-index{
  font-variant-numeric: tabular-nums;
  font-weight: 600;
  color: color-mix(in oklab, var(--text) 92%, var(--muted));
  min-width: 24px;
}
.program-exercise-title{ flex: 1; text-align: left; }
.program-exercise-tag{
  font-size: 10px;
  font-weight: 700;
  letter-spacing: .08em;
  text-transform: uppercase;
  padding: 2px 6px;
  border-radius: 999px;
  background: color-mix(in oklab, var(--link) 16%, var(--surface));
  color: color-mix(in oklab, var(--link) 70%, var(--text));
  white-space: nowrap;
}
.program-exercise-tag--drop{
  background: color-mix(in oklab, #f6c07f 30%, var(--surface));
  color: color-mix(in oklab, #a75a00 70%, var(--text));
}
.program-exercise-flags{
  display: flex;
  gap: 6px;
  align-items: center;
}
.program-exercise-content{
  padding:
    clamp(6px, 1.4vw, 10px)
    clamp(16px, 2.6vw, 22px)
    clamp(14px, 2.4vw, 18px)
    clamp(24px, 3vw, 32px);
  font-size: 13px;
  color: var(--muted);
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 0;
  opacity: 0;
  overflow: hidden;
  transform: translateY(-4px);
  transition: max-height .32s ease, opacity .22s ease, transform .32s ease;
  will-change: max-height, opacity, transform;
  background: transparent;
}
.program-exercise-details[open] .program-exercise-content{
  max-height: 2000px;
  opacity: 1;
  transform: translateY(0);
}
.program-exercise-content--minimal{
  padding-top: clamp(4px, 1vw, 8px);
}
.program-exercise-meta{ font-weight: 500; }
.program-exercise-notes{ margin: 0; line-height: 1.4; }
.exercise-sets-table{
  display: grid;
  gap: 6px;
}
.exercise-sets-table__row{
  display: grid;
  grid-template-columns: minmax(48px, .6fr) repeat(2, minmax(96px, 1fr));
  gap: 12px;
  padding: 10px 14px;
  border-radius: 12px;
  background: color-mix(in oklab, var(--surface) 96%, var(--bg));
  color: var(--text);
  font-weight: 600;
  font-size: 13px;
}
.exercise-sets-table__row--header{
  background: color-mix(in oklab, var(--surface) 88%, var(--bg));
  color: var(--muted);
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .03em;
  font-size: 11px;
}
.exercise-sets-table__cell{
  display: flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
}
.program-exercise-group{
  list-style: none;
  padding: clamp(8px, 1.6vw, 12px);
  border-radius: clamp(14px, 2.6vw, 18px);
  border: 1px solid color-mix(in oklab, var(--surface) 70%, var(--bg));
  background: color-mix(in oklab, var(--surface) 90%, transparent);
}
.program-exercise-group__list{
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: clamp(6px, 1.2vw, 10px);
}
.exercise-sets-link{
  width: auto;
  border: none;
  background: transparent;
  color: color-mix(in oklab, var(--text) 72%, var(--link));
  font-size: 12.5px;
  font-weight: 600;
  padding: 0 0 6px;
  text-align: left;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  display: inline;
  align-self: flex-start;
}
.exercise-sets-link:hover{
  color: color-mix(in oklab, var(--text) 86%, var(--link));
}
.program-exercise-actions{
  margin-top: 8px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: flex-start;
}
.program-exercise-details:not([open]) .program-exercise-actions{
  display: none;
}
.program-exercise-edit-btn{
  width: auto !important;
  max-width: none !important;
  min-height: 38px !important;
  padding: 8px 14px !important;
  font-size: 13.5px !important;
  font-weight: 700 !important;
  border-radius: 14px !important;
  border: none !important;
  background: var(--accent) !important;
  color: var(--accent-contrast) !important;
  box-shadow: none !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  align-self: center !important;
  transition: transform .08s ease, background .18s ease, color .18s ease, border-color .18s ease;
}
.program-exercise-edit-btn:hover{ transform: translateY(-1px); }
.program-exercise-edit-btn:active{
  transform: translateY(0);
}
.exercise-refresh-btn{
  width: 32px;
  height: 32px;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--border) 90%, transparent);
  background: color-mix(in oklab, var(--surface) 92%, var(--bg));
  color: color-mix(in oklab, var(--muted) 80%, var(--text));
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: color .18s ease, border-color .18s ease, background .18s ease, transform .12s ease;
  padding: 0;
}
.exercise-refresh-btn:hover{
  color: color-mix(in oklab, var(--text) 82%, var(--link));
  border-color: color-mix(in oklab, var(--link) 34%, var(--border));
  background: color-mix(in oklab, var(--surface) 88%, var(--bg));
}
.exercise-refresh-btn:active{
  transform: scale(.96);
}
.exercise-refresh-btn svg{
  width: 16px;
  height: 16px;
  pointer-events: none;
}

@keyframes accordion-in{
  from{ opacity: 0; transform: translateY(-6px); }
  to{ opacity: 1; transform: translateY(0); }
}
@keyframes spin{ to{ transform: rotate(360deg); } }

@media (prefers-reduced-motion: reduce){
  .program-day-list,
  .program-exercise-content{
    transition: none;
    transform: none;
  }
}

.history-list{
  list-style: none;
  padding: 0;
  margin: clamp(16px, 2.4vw, 24px) 0 0;
  max-height: 64vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: clamp(12px, 2vw, 18px);
}
.history-panel{
  width: 100%;
  max-width: 760px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(14px, 2.6vw, 24px);
  padding: 0;
}
.program-panel{
  width: 100%;
  align-items: stretch;
}
.program-panel > *{
  width: 100%;
}
.program-panel #program-date{
  max-width: 720px;
  margin-left: auto;
  margin-right: auto;
}
.history-controls{
  display: flex;
  align-items: center;
  justify-content: flex-end;
  width: 100%;
  max-width: 720px;
  align-self: stretch;
  margin: 0 auto;
  padding-inline: clamp(6px, 2vw, 12px);
  padding-top: 2px;
  position: sticky;
  top: 62px;
  z-index: 11;
}
.sort-menu{
  position: relative;
  display: inline-flex;
}
.sort-trigger{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 14px;
  min-height: 36px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--surface) 85%, var(--bg));
  color: var(--text);
  font-size: 13px;
  line-height: 1.2;
  font-weight: 600;
  cursor: pointer;
  transition: transform .08s ease, background .18s ease, color .18s ease, border-color .18s ease, box-shadow .18s ease;
}
.sort-trigger:hover{
  transform: translateY(-1px);
  color: color-mix(in oklab, var(--text) 86%, var(--link));
  background: color-mix(in oklab, var(--surface) 80%, transparent);
}
.sort-trigger:active{ transform: translateY(0); }
.sort-trigger__icon{
  width: 18px;
  height: 18px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: color-mix(in oklab, var(--text) 78%, var(--link));
}
.sort-trigger__chevron{
  margin-left: 2px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: color-mix(in oklab, var(--text) 55%, var(--muted));
}
.sort-dropdown{
  position: absolute;
  top: calc(100% + 10px);
  right: 0;
  min-width: 200px;
  border-radius: 12px;
  background: color-mix(in oklab, var(--surface) 92%, var(--bg));
  border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
  box-shadow: 0 10px 22px color-mix(in oklab, var(--text) 12%, transparent);
  padding: 4px;
  z-index: 10;
  transform-origin: top right;
  animation: dropdownFade 260ms ease;
}
@keyframes dropdownFade{
  from{
    opacity: 0;
    transform: translateY(-6px) scale(0.98);
  }
  to{
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
.sort-option{
  width: 100%;
  text-align: left;
  appearance: none;
  border: none;
  background: transparent;
  color: var(--text);
  font-size: 14px;
  font-weight: 600;
  padding: 10px 12px;
  border-radius: 10px;
  cursor: pointer;
  transition: background .18s ease, color .18s ease;
}
.sort-option:hover{
  background: color-mix(in oklab, var(--surface) 72%, transparent);
}
.sort-option.is-active{
  color: color-mix(in oklab, var(--accent) 86%, var(--text));
  background: color-mix(in oklab, var(--accent) 12%, transparent);
}

.exercise-dialog{
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(6, 11, 24, 0.55);
  z-index: 120;
  padding: 16px;
}
.exercise-dialog[data-state="open"]{
  display: flex;
}
.exercise-dialog__panel{
  width: min(360px, 92vw);
  border-radius: 18px;
  padding: 24px clamp(20px, 4vw, 28px) clamp(20px, 3.6vw, 26px);
  background: color-mix(in oklab, var(--surface) 96%, var(--bg));
  color: var(--text);
  box-shadow: 0 20px 48px rgba(9, 14, 24, 0.25);
  border: 1px solid color-mix(in oklab, var(--border) 80%, transparent);
  outline: none;
}
.exercise-dialog__title{
  margin: 0 0 8px;
  font-size: 18px;
  font-weight: 700;
  color: color-mix(in oklab, var(--text) 94%, var(--accent));
}
.exercise-dialog__body{
  margin: 0 0 20px;
  line-height: 1.5;
  color: var(--muted);
  font-size: 14px;
}
.exercise-dialog__message{
  margin: 0;
}
.exercise-dialog__media{
  display: block;
  width: 100%;
  height: auto;
  border-radius: 14px;
  background: color-mix(in oklab, var(--surface) 80%, var(--bg));
  box-shadow: 0 10px 30px rgba(9, 14, 24, 0.2);
}
.exercise-dialog__actions{
  display: flex;
  justify-content: flex-end;
  gap: 10px;
}
.exercise-dialog__actions .primary-button{
  width: auto;
  max-width: none;
  min-width: 120px;
  padding: 12px 18px;
  font-size: 14px;
}
.button-spinner{
  width: 16px;
  height: 16px;
  border-radius: 999px;
  border: 2px solid color-mix(in oklab, var(--accent-contrast) 40%, transparent);
  border-top-color: var(--accent-contrast);
  display: inline-block;
  animation: spin 0.7s linear infinite;
}
.exercise-edit-dialog__panel{
  position: relative;
  width: min(520px, 94vw);
  max-height: min(82vh, 680px);
  min-height: min(68vh, 620px);
  padding: 22px clamp(18px, 4vw, 28px) 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow: hidden;
}
.exercise-edit-dialog__header{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}
.exercise-edit-dialog__title{
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  color: color-mix(in oklab, var(--text) 92%, var(--accent));
  flex: 1;
}
.exercise-edit-dialog__body{
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow: auto;
  padding-right: 2px;
}
.exercise-edit-dialog__list{
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding-left: 20px;
}
.exercise-edit-dialog__list-header{
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 10px;
  align-items: center;
  padding: 2px 0 6px;
  font-size: 12px;
  font-weight: 600;
  color: var(--muted);
  padding-left: 20px;
}
.exercise-edit-dialog__list-header-label{
  min-width: 54px;
}
.exercise-edit-dialog__list-header-spacer{
  width: 40px;
  height: 1px;
}
.exercise-edit-dialog__set{
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 10px;
  align-items: center;
  padding: 6px 0;
}
.exercise-edit-dialog__set-label{
  font-size: 13px;
  font-weight: 600;
  color: var(--muted);
  min-width: 54px;
  align-self: center;
  line-height: 1;
}
.exercise-edit-dialog__fields{
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
  align-items: center;
}
.exercise-edit-dialog__field{
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 12px;
  color: var(--muted);
}
.exercise-edit-dialog__field-label{
  font-weight: 600;
}
.exercise-edit-dialog__input{
  height: 44px;
  border-radius: 12px;
  border: 1px solid color-mix(in oklab, var(--border) 86%, transparent);
  background: color-mix(in oklab, var(--surface) 98%, var(--bg));
  padding: 8px 12px;
  font-size: 15px;
  font-weight: 600;
  color: var(--text);
}
.exercise-edit-dialog__input:focus{
  outline: 2px solid color-mix(in oklab, var(--accent) 60%, transparent);
  outline-offset: 1px;
}
.exercise-edit-dialog__delete{
  width: 40px;
  height: 40px;
  border: none;
  background: transparent;
  color: #d94f4f;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: color .18s ease, transform .12s ease, opacity .18s ease;
  align-self: center;
}
.exercise-edit-dialog__delete:hover{
  color: #c13a3a;
}
.exercise-edit-dialog__delete:active{
  transform: scale(.96);
}
.exercise-edit-dialog__delete:disabled{
  opacity: .45;
  cursor: not-allowed;
}
.exercise-edit-dialog__add{
  align-self: stretch;
  padding: 12px 16px;
  font-weight: 600;
}
.exercise-edit-dialog__footer{
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
  margin-top: auto;
  padding-top: 10px;
  padding-bottom: 6px;
  position: sticky;
  bottom: 0;
  background: color-mix(in oklab, var(--surface) 96%, var(--bg));
  border-top: 1px solid color-mix(in oklab, var(--border) 70%, transparent);
}
.exercise-edit-dialog__footer .button-ghost,
.exercise-edit-dialog__footer .primary-button{
  width: 100%;
  max-width: none;
  min-height: 46px;
  font-size: 14px;
}
.exercise-edit-dialog__secondary{
  position: sticky;
  bottom: 0;
  padding-bottom: calc(8px + env(safe-area-inset-bottom));
  background: color-mix(in oklab, var(--surface) 96%, var(--bg));
}
.exercise-edit-dialog__replace{
  width: 100%;
  border: none;
  background: transparent;
  color: color-mix(in oklab, var(--text) 78%, var(--link));
  font-size: 13px;
  font-weight: 600;
  padding: 6px 8px calc(10px + env(safe-area-inset-bottom));
  cursor: pointer;
}
.exercise-edit-dialog__replace:hover{
  color: color-mix(in oklab, var(--text) 90%, var(--link));
}

button{
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
.button-ghost{
  border: 1px solid color-mix(in oklab, var(--border) 86%, transparent);
  background: transparent;
  color: var(--text);
  border-radius: 12px;
  padding: 11px 18px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: color .18s ease, border-color .18s ease, background .18s ease;
}
.button-ghost:hover{
  color: color-mix(in oklab, var(--text) 82%, var(--link));
  border-color: color-mix(in oklab, var(--link) 30%, var(--border));
  background: color-mix(in oklab, var(--surface) 80%, transparent);
}
.button-ghost:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 60%, transparent);
  outline-offset: 2px;
}

.history-list li{
  padding: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}
.history-list .history-link{
  color: var(--text);
  text-decoration: none;
  font-weight: 500;
}
.history-list li:hover .history-link{ color: var(--link); }

/* ===== Segmented control (wide, centered) ===== */
.segmented-container{
  width: 100%;
  display: flex;
  justify-content: center;
  margin-top: clamp(12px, 2.6vw, 24px);
  margin-bottom: clamp(14px, 2.6vw, 26px);
}

#segmented{
  display:flex;
  justify-content:center;
  margin-top: clamp(12px, 2.6vw, 24px);
  margin-bottom: clamp(12px, 2.4vw, 22px);
  padding: 0;
  width: 100%;
}

.segmented{
  display:flex;
  align-items: center;
  width: 100%;
  max-width: clamp(320px, 92vw, 640px);
  padding: 2px;
  gap: 4px;
  border: 1px solid color-mix(in oklab, var(--text) 18%, transparent);
  border-radius: 999px;
  background: color-mix(in oklab, var(--surface) 58%, transparent);
  box-shadow:
    inset 0 1px 1px color-mix(in oklab, var(--text) 10%, transparent);
}

.segmented__tab{
  flex: 1 1 0;
  appearance: none;
  border: 0;
  background: transparent;
  color: color-mix(in oklab, var(--text) 68%, var(--muted));
  font-weight: 700;
  font-size: 12px;
  padding: 4px 10px;
  border-radius: 999px;
  cursor: pointer;
  text-align: center;
  transition: background .2s ease, color .2s ease, box-shadow .2s ease, transform .06s ease;
}

.segmented__tab:hover{
  color: color-mix(in oklab, var(--text) 85%, var(--link));
  background: color-mix(in oklab, var(--surface) 76%, transparent);
}

.segmented__tab:active{ transform: translateY(0); }

.segmented__tab[aria-selected="true"],
.segmented__tab.is-active{
  background: var(--bg);
  color: var(--text);
  box-shadow:
    0 1px 0 color-mix(in oklab, var(--text) 7%, transparent),
    0 2px 10px color-mix(in oklab, var(--text) 10%, transparent);
}

.segmented__tab:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 50%, transparent);
  outline-offset: 2px;
}

@media (max-width: 380px){
  .segmented__tab{ font-size: 11.5px; padding: 4px 9px; }
}

.history-list::-webkit-scrollbar{ width: 10px; }
.history-list::-webkit-scrollbar-thumb{
  background-color: color-mix(in oklab, var(--text) 18%, transparent);
  border-radius: 999px;
  border: 2px solid var(--bg);
}
.history-list::-webkit-scrollbar-track{ background: transparent; }

a{ color: var(--link); }
a:hover{ opacity: .9; }

@media (max-width: 420px){
  main#app{
    --app-padding-top: 18px;
    --app-padding-right: 18px;
    --app-padding-bottom: 18px;
    --app-padding-left: 18px;
  }
  .history-footer{ padding-bottom: env(safe-area-inset-bottom); }
}
.history-empty{
  margin-top: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  gap: clamp(10px, 1vh, 14px);
  min-height: clamp(120px, 22vh, 220px);
  padding-block: clamp(4px, 1.4vh, 12px);
}
.history-empty__image{
  display: block;
  width: clamp(160px, 46vw, 220px);
  height: clamp(120px, 36vw, 180px);
  object-fit: contain;
  margin: 0 auto clamp(2px, .6vh, 8px);
}
.history-empty__caption{
  font-size: 16px;
  font-weight: 500;
  color: var(--text);
  margin: 0;
}

.subscription-confirm{
  position: fixed;
  inset: 0;
  z-index: 1200;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 18px;
  background: color-mix(in oklab, var(--bg) 35%, rgba(0, 0, 0, .6));
}
.subscription-confirm__dialog{
  width: min(92vw, 420px);
  background: color-mix(in oklab, var(--surface) 92%, var(--bg));
  border-radius: 16px;
  padding: 20px 18px;
  box-shadow: var(--shadow-strong);
  border: 1px solid var(--border);
}
.subscription-confirm__title{
  margin: 0 0 10px;
  font-size: 18px;
}
.subscription-confirm__body{
  margin: 0 0 18px;
  line-height: 1.45;
  color: var(--muted);
}
.subscription-confirm__actions{
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}
.subscription-confirm__btn{
  padding: 10px 14px;
  border-radius: 10px;
  font-weight: 600;
  cursor: pointer;
}
.subscription-confirm__btn--cancel{
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--bg) 90%, var(--surface));
  color: var(--text);
}
.subscription-confirm__btn--confirm{
  border: none;
  background: var(--accent);
  color: var(--accent-contrast);
}

.intro-modal{
  position: fixed;
  inset: 0;
  z-index: 1200;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 18px;
  background: color-mix(in oklab, var(--bg) 35%, rgba(0, 0, 0, .6));
}
.intro-modal__dialog{
  width: min(92vw, 440px);
  background: color-mix(in oklab, var(--surface) 92%, var(--bg));
  border-radius: 18px;
  padding: 22px 20px;
  box-shadow: var(--shadow-strong);
  border: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.intro-modal__title{
  margin: 0;
  font-size: 18px;
}
.intro-modal__text{
  margin: 0;
  line-height: 1.45;
  color: var(--muted);
}
.intro-modal__btn{
  align-self: flex-end;
  margin-top: 6px;
  padding: 10px 16px;
  border-radius: 10px;
  border: none;
  background: var(--accent);
  color: var(--accent-contrast);
  font-weight: 600;
  cursor: pointer;
}

.week.centered{
  max-width: 720px;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
}

.empty-illustration{
  width: clamp(160px, 46vw, 200px);
  height: clamp(120px, 36vw, 170px);
  margin: 0 auto 16px;
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
  filter: drop-shadow(0 4px 12px color-mix(in oklab, var(--text) 14%, transparent));
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='360' height='260' viewBox='0 0 360 260' fill='none'><defs><linearGradient id='g1' x1='50' y1='30' x2='310' y2='210' gradientUnits='userSpaceOnUse'><stop stop-color='%23C7DFFF'/><stop offset='1' stop-color='%23E7EEFF'/></linearGradient><linearGradient id='g2' x1='120' y1='80' x2='240' y2='200' gradientUnits='userSpaceOnUse'><stop stop-color='%237AA7FF'/><stop offset='1' stop-color='%235B8BFF'/></linearGradient></defs><rect x='30' y='24' width='300' height='200' rx='28' fill='url(%23g1)'/><rect x='62' y='56' width='236' height='136' rx='18' fill='white' stroke='%23B8C7E6' stroke-width='3'/><path d='M90 174c18-30 42-30 60 0s42 30 60 0 42-30 60 0' stroke='%23A7B9DB' stroke-width='6' stroke-linecap='round' fill='none'/><circle cx='136' cy='106' r='16' fill='url(%23g2)'/><circle cx='216' cy='118' r='12' fill='%23E6ECFC'/><circle cx='248' cy='94' r='8' fill='%23E6ECFC'/></svg>");
}

@media print{
  body{ background:#fff; color:#000; }
  main#app{ box-shadow:none; border-color:#ddd; }
  .history-footer{ display:none; }
}
:where(.app-header) :is(h1, .page-title, #page-title) {
  margin: 0;
  font-size: clamp(22px, 5vw, 28px) !important;
  font-weight: 700;
  text-align: center;
}

.week {
  display: flex;
  flex-direction: column;
  gap: clamp(10px, 1.8vw, 16px);
}
.week > li { list-style: none; }
.week > li + li { margin-top: clamp(10px, 1.8vw, 16px); }

.week > li > :is(a, button, div) {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  text-align: left;
  text-decoration: none;
  color: inherit;
  padding: clamp(18px, 2.6vw, 24px) clamp(22px, 3.2vw, 30px);
  border: 1px solid var(--border);
  border-radius: clamp(16px, 3vw, 22px);
  background: color-mix(in oklab, var(--surface) 82%, transparent);
  transition: color .25s ease, background .25s ease, box-shadow .25s ease;
}

.week > li > :is(a, button, div):hover {
  color: color-mix(in oklab, var(--text) 84%, var(--link));
  background: color-mix(in oklab, var(--surface) 72%, transparent);
}

#segmented { display:flex; justify-content:center; margin-top: clamp(40px, 6vw, 60px); margin-bottom: clamp(24px, 4vw, 36px); padding: 0; width:100%; }

#segmented .segmented {
  display:flex; align-items:center;
  width:100%; max-width:clamp(320px, 92vw, 640px);
  padding:2px; gap:4px;
  border:1px solid color-mix(in oklab, var(--text) 18%, transparent);
  border-radius:999px;
  background: color-mix(in oklab, var(--surface) 58%, transparent);
  box-shadow:
    inset 0 1px 1px color-mix(in oklab, var(--text) 10%, transparent);
}

#segmented button.segmented__tab {
  all: unset;
  display:block;
  flex:1 1 0;
  text-align:center;
  cursor:pointer;
  user-select:none;
  padding:4px 10px;
  border-radius:999px;
  font-weight:700;
  font-size:12px;
  color: color-mix(in oklab, var(--text) 68%, var(--muted));
  transition: background .2s ease, color .2s ease, box-shadow .2s ease, transform .06s ease;
}

#segmented button.segmented__tab:hover {
  color: color-mix(in oklab, var(--text) 85%, var(--link));
  background: color-mix(in oklab, var(--surface) 76%, transparent);
}

#segmented button.segmented__tab[aria-selected="true"],
#segmented button.segmented__tab.is-active {
  background: var(--bg);
  color: var(--text);
  box-shadow:
    0 1px 0 color-mix(in oklab, var(--text) 7%, transparent),
    0 2px 10px color-mix(in oklab, var(--text) 10%, transparent);
}

#segmented button.segmented__tab:focus-visible {
  outline:2px solid color-mix(in oklab, var(--accent) 50%, transparent);
  outline-offset:2px;
}

@media (max-width: 380px){
  #segmented button.segmented__tab { font-size:11.5px; padding:4px 9px; }
}

.weekly-survey{
  gap: clamp(18px, 2.4vw, 26px);
}
.weekly-survey__notice{
  margin: 0;
}
.weekly-survey__header{
  display: flex;
  flex-direction: column;
  gap: 6px;
  text-align: center;
}
.weekly-survey__title{
  font-size: clamp(20px, 3.8vw, 24px);
  font-weight: 700;
}
.weekly-survey__subtitle{
  font-size: 13px;
  color: var(--muted);
}
.weekly-survey__viewport{
  position: relative;
  overflow: hidden;
  border-radius: 18px;
  background: color-mix(in oklab, var(--surface) 80%, var(--bg));
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
}
.weekly-survey__track{
  display: flex;
  transition: transform 280ms cubic-bezier(.2,.7,.2,1);
  will-change: transform;
}
.weekly-survey__day{
  flex: 0 0 100%;
  padding: clamp(14px, 2.2vw, 18px);
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.weekly-survey__card{
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.weekly-survey__exercise{
  border-radius: 16px;
  padding: 12px 12px 14px;
  background: color-mix(in oklab, var(--bg) 90%, var(--surface));
  border: 1px solid color-mix(in oklab, var(--text) 12%, transparent);
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.weekly-survey__exercise-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}
.weekly-survey__exercise-name{
  font-weight: 600;
  line-height: 1.3;
}
.weekly-survey__edit{
  width: 36px;
  height: 36px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--surface) 80%, var(--bg));
  color: color-mix(in oklab, var(--text) 85%, var(--accent));
  cursor: pointer;
  transition: transform .08s ease, background .2s ease, color .2s ease;
}
.weekly-survey__edit:hover{
  transform: translateY(-1px);
  background: color-mix(in oklab, var(--surface) 70%, var(--bg));
}
.weekly-survey__edit:active{ transform: translateY(0); }
.weekly-survey__slider-wrap{
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.weekly-survey__comment{
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.weekly-survey__comment-btn{
  align-self: flex-start;
  padding: 6px 12px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--surface) 82%, var(--bg));
  color: color-mix(in oklab, var(--text) 80%, var(--muted));
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: transform .08s ease, background .2s ease, color .2s ease;
}
.weekly-survey__comment-btn:hover{
  transform: translateY(-1px);
  background: color-mix(in oklab, var(--surface) 70%, var(--bg));
}
.weekly-survey__comment-btn:active{ transform: translateY(0); }
.weekly-survey__comment-input{
  width: 100%;
  min-height: 84px;
  resize: vertical;
  border-radius: 12px;
  border: 1px solid var(--border);
  padding: 10px 12px;
  font: inherit;
  background: color-mix(in oklab, var(--bg) 92%, var(--surface));
  color: var(--text);
  outline: none;
}
.weekly-survey__comment-input:focus-visible{
  border-color: color-mix(in oklab, var(--accent) 45%, var(--border));
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--accent) 28%, transparent);
}
.weekly-survey__slider{
  --slider-color: #58c46c;
  width: 100%;
  height: 6px;
  border-radius: 999px;
  appearance: none;
  background: color-mix(in oklab, var(--slider-color) 75%, var(--surface));
  outline: none;
}
.weekly-survey__slider::-webkit-slider-runnable-track{
  height: 6px;
  border-radius: 999px;
  background: color-mix(in oklab, var(--slider-color) 75%, var(--surface));
}
.weekly-survey__slider::-webkit-slider-thumb{
  appearance: none;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--slider-color);
  border: 2px solid color-mix(in oklab, var(--slider-color) 55%, var(--bg));
  margin-top: -7px;
  box-shadow: 0 6px 16px color-mix(in oklab, var(--slider-color) 35%, transparent);
}
.weekly-survey__slider::-moz-range-track{
  height: 6px;
  border-radius: 999px;
  background: color-mix(in oklab, var(--slider-color) 75%, var(--surface));
}
.weekly-survey__slider::-moz-range-thumb{
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--slider-color);
  border: 2px solid color-mix(in oklab, var(--slider-color) 55%, var(--bg));
  box-shadow: 0 6px 16px color-mix(in oklab, var(--slider-color) 35%, transparent);
}
.weekly-survey__scale{
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: var(--muted);
}
.weekly-survey__footer{
  margin-top: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.weekly-survey__skip{
  width: 100%;
}
.weekly-survey__next{
  width: 100%;
}

.profile-balance{
  padding: clamp(14px, 2vw, 18px);
  border-radius: 18px;
  background: color-mix(in oklab, var(--surface) 90%, var(--bg));
  box-shadow: 0 12px 28px color-mix(in oklab, var(--text) 12%, transparent);
}
.profile-balance__header{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  flex-wrap: wrap;
}
@media (max-width: 520px){
  .profile-balance__header{
    align-items: stretch;
  }
}
.profile-balance__title{
  margin: 0;
  font-size: 12px;
  color: var(--muted);
  letter-spacing: .08em;
  text-transform: uppercase;
}
.profile-balance__value{
  margin: 6px 0 0;
  font-size: clamp(22px, 4vw, 30px);
  font-weight: 700;
}
.profile-balance__button{
  min-width: min(180px, 100%);
}
.profile-balance__button.is-pressed{
  transform: translateY(1px) scale(0.98);
}
.profile-flow{
  overflow: hidden;
}
.profile-flow__track{
  display: flex;
  width: 200%;
  transition: transform .28s ease;
}
.profile-flow[data-view="edit"] .profile-flow__track{
  transform: translateX(-50%);
}
.profile-pane{
  width: 50%;
  padding: 4px 2px;
}
.profile-list{
  border-top: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
}
.profile-row{
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 2px;
  background: transparent;
  border: none;
  border-bottom: 1px solid color-mix(in oklab, var(--text) 14%, transparent);
  text-align: left;
  cursor: pointer;
}
.profile-row__label{
  margin: 0 0 4px;
  font-size: 12px;
  color: var(--muted);
}
.profile-row__value{
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  white-space: pre-wrap;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
.profile-row__chevron{
  display: inline-flex;
  color: color-mix(in oklab, var(--text) 60%, var(--muted));
  transform: rotate(-90deg);
}
.profile-edit{
  display: flex;
  flex-direction: column;
  gap: 14px;
  padding: 8px 4px 0;
}
.profile-edit__input{
  width: 100%;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--surface) 85%, var(--bg));
  color: var(--text);
  font-size: 14px;
  font-family: inherit;
}
.profile-edit__input:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--accent) 55%, transparent);
  outline-offset: 2px;
}
.profile-edit__input:disabled{
  opacity: 0.6;
}
.profile-select{
  width: 100%;
}
.profile-select__trigger{
  width: 100%;
  justify-content: space-between;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--surface) 85%, var(--bg));
  font-size: 14px;
}
.profile-select__dropdown{
  left: 0;
  right: 0;
  top: calc(100% + 8px);
  min-width: unset;
}
.profile-edit__textarea{
  resize: vertical;
  min-height: 96px;
}
.profile-edit__actions{
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}
.profile-checklist{
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-height: 240px;
  overflow-y: auto;
  padding: 6px 4px;
}
.profile-checklist__item{
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 14px;
  color: var(--text);
}
.profile-checklist__item input{
  width: 16px;
  height: 16px;
}
.topup-shell{
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 4px 0 0;
}
.topup-page-shell{
  gap: 8px;
  align-self: stretch;
  width: 100vw;
  margin-top: calc(-1 * var(--app-padding-top) - 18px);
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  padding-inline: 0;
  max-width: none;
}
.topup-carousel{
  width: 100%;
  overflow-x: auto;
  overflow-y: hidden;
  scroll-snap-type: x mandatory;
  scroll-snap-stop: always;
  scroll-behavior: auto;
  scrollbar-width: none;
  user-select: none;
  padding: 0 0 8px;
  display: flex;
  gap: 5vw;
  align-items: center;
  -webkit-overflow-scrolling: touch;
  scroll-padding-inline: 0;
}
.topup-carousel::-webkit-scrollbar{
  width: 0;
  height: 0;
}
.topup-carousel__card{
  flex: 0 0 auto;
  width: 96vw;
  border-radius: 24px;
  overflow: hidden;
  margin-right: -44vw;
  scroll-snap-align: center;
  transform: scale(0.90);
  transition: transform 320ms cubic-bezier(.2,.7,.2,1);
  z-index: 1;
  background: transparent;
  cursor: pointer;
}
.topup-carousel__card.is-active{
  transform: scale(1);
  z-index: 2;
}
.topup-carousel__image{
  width: 170%;
  height: auto;
  display: block;
  margin-left: -35%;
  transform-origin: center;
  pointer-events: none;
}
.topup-carousel__card[data-id="start"] .topup-carousel__image{
  transform: scale(1.06);
}
.topup-carousel__dots{
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  margin: 0;
  z-index: 12;
}
.topup-carousel__dot{
  width: 10px;
  height: 10px;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--text) 35%, transparent);
  background: transparent;
  padding: 0;
  cursor: pointer;
}
.topup-carousel__dot.is-active{
  background: var(--accent);
  border-color: var(--accent);
  box-shadow: 0 0 0 6px color-mix(in oklab, var(--accent) 30%, transparent);
}
.topup-pay{
  width: min(100%, 340px);
  align-self: center;
  padding: 14px 18px;
  font-size: 16px;
}
.topup-cta{
  position: fixed;
  left: 0;
  right: 0;
  bottom: calc(var(--bottom-nav-offset) + env(safe-area-inset-bottom, 0px) + 12px);
  display: flex;
  justify-content: center;
  padding: 0 16px;
}
@media (min-width: 900px){
  .topup-page-shell{
    margin-top: calc(-1 * var(--app-padding-top) - 18px);
  }
}
.faq-support{
  display: flex;
  justify-content: center;
  padding-bottom: clamp(8px, 2vw, 16px);
}
.faq-support__button{
  width: 100%;
  max-width: 360px;
}

.with-bottom-nav{
  --bottom-nav-offset: 58px;
  padding-bottom: calc(var(--bottom-nav-offset) + env(safe-area-inset-bottom, 0px));
}
.bottom-nav{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1100;
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 2px;
  padding: 6px 12px calc(6px + env(safe-area-inset-bottom, 0px));
  background: color-mix(in oklab, var(--surface) 92%, transparent);
  border-top: 1px solid color-mix(in oklab, var(--text) 10%, transparent);
  backdrop-filter: blur(10px) saturate(1.2);
  -webkit-backdrop-filter: blur(10px) saturate(1.2);
}
.bottom-nav__item{
  border: none;
  background: transparent;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 6px 4px;
  border-radius: 10px;
  color: color-mix(in oklab, var(--text) 72%, var(--muted));
  font-size: 10.5px;
  font-weight: 600;
  cursor: pointer;
  transition: color .18s ease, background .18s ease, transform .12s ease;
}
.bottom-nav__item:hover{
  background: color-mix(in oklab, var(--surface) 78%, transparent);
  color: color-mix(in oklab, var(--text) 70%, var(--muted));
}
.bottom-nav__item:active{
  transform: translateY(1px);
}
.bottom-nav__item.is-active{
  color: color-mix(in oklab, var(--accent) 92%, var(--text));
  background: color-mix(in oklab, var(--accent) 10%, transparent);
}
.bottom-nav__icon{
  width: 20px;
  height: 20px;
  display: block;
  background-color: currentColor;
  -webkit-mask-image: var(--icon-url);
  mask-image: var(--icon-url);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-size: contain;
  mask-size: contain;
  opacity: 0.92;
}
.bottom-nav__item.is-active .bottom-nav__icon{
  opacity: 1;
}
.bottom-nav__label{
  line-height: 1.1;
  text-align: center;
}
.profile-danger{
  display: flex;
  justify-content: center;
  padding-bottom: clamp(10px, 2vw, 18px);
}
.profile-danger__button{
  width: 100%;
  max-width: 360px;
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid color-mix(in oklab, #ff6b6b 45%, var(--border));
  background: color-mix(in oklab, var(--surface) 90%, var(--bg));
  color: color-mix(in oklab, #ff6b6b 70%, var(--text));
  font-weight: 600;
  cursor: pointer;
}
.profile-danger__button:hover{
  background: color-mix(in oklab, #ff6b6b 8%, var(--surface));
}
